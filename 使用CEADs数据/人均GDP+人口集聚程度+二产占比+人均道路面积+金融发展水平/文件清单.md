# 文件清单 - 二产占比模型PSM分析

**文件夹**: `人均GDP+人口集聚程度+二产占比+人均道路面积+金融发展水平`

## 主要数据文件

1. **总数据集_2007-2023_含二产占比_含金融发展水平.xlsx** (1.2 MB)
   - 完整的回归数据集
   - 包含所有必要的变量: ln_carbon_intensity, treat, post, did, 控制变量等
   - 来源: 合并主数据集 + secondary_share

2. **PSM_匹配后数据集.xlsx** (790 KB)
   - **这是最重要的文件**,用于PSM-DID回归
   - 2,942个观测 (1,471处理组 + 1,471对照组)
   - 包含匹配后的完整数据

## PSM结果文件

3. **PSM_平衡性检验.xlsx** (11 KB)
   - Sheet 1: 总体平衡性 (5个变量的标准化偏差)
   - Sheet 2: 分年度平衡性 (每年每个变量的偏差)

4. **PSM_年度统计.xlsx** (5.9 KB)
   - 每年的处理组/对照组数量
   - Logit回归伪R²
   - 倾向得分均值

5. **PSM_汇总报告.xlsx** (5.9 KB)
   - Sheet 1: 概况 (样本量、匹配率等)
   - Sheet 2: 平衡性汇总 (匹配前后偏差对比)

## 脚本文件

6. **psm_secondary_share.py** (20 KB)
   - 主要PSM分析脚本
   - 包含完整的PSM流程: 缺失值处理 → Logit回归 → 匹配 → 平衡性检验 → 报告生成

7. **merge_secondary_share.py** (2.9 KB)
   - 数据准备脚本
   - 将secondary_share从现有数据集合并到主数据集

8. **prepare_data.py** (1.7 KB)
   - 数据检查脚本
   - 验证变量存在性和数据质量

9. **check_existing.py** (1.8 KB)
   - 检查现有数据集脚本
   - 确认secondary_share变量

10. **check_industry_data.py** (830 B)
    - 检查原始产业结构数据
    - 用于数据探索

## 文档文件

11. **PSM分析报告_二产占比模型.md** (6.2 KB)
    - 完整的PSM分析报告
    - 包含结果解读、与其他模型对比、结论与建议

## 如何使用这些文件

### 1. 进行PSM-DID回归
```python
import pandas as pd

# 读取匹配后数据
df = pd.read_excel('PSM_匹配后数据集.xlsx')

# 进行DID回归 (使用LSDV方法)
# Y = ln_carbon_intensity
# X = did + ln_pgdp + ln_pop_density + secondary_share + ln_road_area + financial_development
# Fixed effects: city FE + year FE
```

### 2. 检查平衡性
打开 `PSM_平衡性检验.xlsx` 查看:
- 总体平衡性sheet: 每个变量的匹配前后偏差
- 分年度平衡性sheet: 每年每个变量的偏差

### 3. 了解匹配质量
打开 `PSM_汇总报告.xlsx` 查看:
- 匹配率、样本量等概况
- 平衡性汇总表

### 4. 重新运行PSM (如需修改卡尺)
```bash
cd "人均GDP+人口集聚程度+二产占比+人均道路面积+金融发展水平"
py psm_secondary_share.py
```

## 关键结果摘要

- **原始样本**: 4,819 观测
- **匹配后样本**: 2,942 观测 (1,471对)
- **平均匹配率**: 94.2%
- **平衡性**: 4/5 变量满足标准 (|bias| < 10%)
- **未平衡变量**: secondary_share (-12.96%, p=0.0004)

## 控制变量说明

本模型使用5个控制变量:

1. **ln_pgdp** - 人均GDP (对数)
   - 捕捉经济发展水平效应

2. **ln_pop_density** - 人口集聚程度 (对数)
   - 核心创新变量: 控制城市形态效应

3. **secondary_share** - 二产占比 (水平值)
   - 控制产业结构效应
   - 匹配后未达到平衡,需在DID回归中重点关注

4. **ln_road_area** - 人均道路面积 (对数)
   - 控制基础设施水平
   - 缺失率24.15%,导致样本删除

5. **financial_development** - 金融发展水平 (水平值)
   - 新增控制变量
   - 匹配后平衡性优秀 (偏差-1.54%, p=0.6753)

## 下一步建议

1. ✓ PSM匹配已完成
2. [ ] 运行PSM-DID回归 (使用 `PSM_匹配后数据集.xlsx`)
3. [ ] 进行平行趋势检验 (Event Study)
4. [ ] 与其他模型结果对比 (tertiary_share模型, industrial_advanced模型)

---

**创建时间**: 2025-01-17
**分析工具**: Python + sklearn
