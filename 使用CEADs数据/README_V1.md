# CEADs碳排放数据处理

本文件夹包含使用CEADs（China Emission Accounts and Datasets）数据进行碳排放强度计算的完整流程。

## 数据源

1. **CEADs碳排放数据**: `1997-2019年290个中国城市碳排放清单 (1).xlsx`
   - 来源：CEADs (http://www.ceads.net)
   - 时间范围：1997-2019年
   - 单位：百万吨CO2
   - 城市数量：290个城市

2. **实际GDP数据**: `../原始数据/296个地级市GDP相关数据（以2000年为基期）.xlsx`
   - 时间范围：2000-2023年（本研究使用2007-2019）
   - 单位：亿元（以2000年为基期）

3. **主数据集**: `总数据集_2007-2023_完整版_无缺失FDI_修正pop_density_添加金融发展水平.xlsx`
   - 来源：主研究的完整数据集
   - 本研究截取2007-2019年子样本

## 处理流程

### Step 1: 数据探索
- 文件：`step1_explore_ceads.py`
- 内容：查看CEADs Excel文件结构，确定数据所在的工作表

### Step 2: 数据清洗
- 文件：`step2b_clean_ceads_fixed.py`（修正版）
- 内容：
  - 提取CEADs核心数据（城市、年份、排放量）
  - 时间截断：保留2007-2019年
  - 构造匹配键：去除省份前缀和城市后缀
  - 清洗实际GDP数据并构造匹配键

**关键修正**：CEADs城市名包含省份前缀（如"四川成都"），需要去除前缀后才能与主数据集匹配。

### Step 3: 数据合并
- 文件：`step3b_merge_data_fixed.py`（修正版）
- 内容：
  - 以主数据集为左表
  - Left Join CEADs数据（通过年份+匹配键）
  - Left Join实际GDP数据（通过年份+匹配键）
  - 检查匹配率和缺失值

**匹配结果**：
- 总观测数：3,705
- CEADs数据匹配率：61.30%（2,271个观测）
- 涉及城市：212/285（74.39%）
- GDP数据匹配率：100%

### Step 4: 计算碳排放强度
- 文件：`step4_calculate_carbon_intensity.py`
- 内容：
  - 单位换算：CEADs排放量（百万吨）/ GDP（亿元）→ 吨/万元
  - 公式：`carbon_intensity = (emission_million_tons / real_gdp_100m_yuan) × 100`
  - 缩尾处理：1%和99%分位数
  - 生成对数变量：`ln_carbon_intensity_ceads`

**结果**：
- 均值：2.80 吨/万元
- 中位数：1.91 吨/万元
- 标准差：2.43 吨/万元
- 范围：0.32 - 12.69 吨/万元（缩尾后）
- 与原有数据相关系数：0.7668

### Step 5: 描述性统计
- 文件：`step5_descriptive_statistics.py`
- 内容：
  - 生成完整的描述性统计报告
  - 处理组与对照组对比
  - 导出统计表

## 关键发现

### 1. 数据覆盖情况
- 总观测数：3,705
- CEADs有效观测数：2,271（61.3%）
- 涉及城市数：212/285（74.4%）

### 2. 碳排放强度水平
- 均值：2.80 吨/万元
- 中位数：1.91 吨/万元
- 标准差：2.43 吨/万元

### 3. 处理组与对照组差异
- 对数碳排放强度：处理组0.4438 vs 对照组0.9013
- 差异：-0.4575（-50.76%）
- **处理组的碳排放强度显著低于对照组**

### 4. 年份分布
观测数在2007-2015年相对稳定（每年168-199个），2016年后开始下降（2019年仅126个），可能与CEADs数据更新滞后有关。

## 最终输出文件

1. **`CEADs_最终数据集_2007-2019.xlsx`** (626 KB)
   - 包含所有核心变量的完整数据集
   - 21个变量，3,705个观测
   - 核心变量：
     - `carbon_intensity_ceads_winsor`: 缩尾后的碳排放强度（吨/万元）
     - `ln_carbon_intensity_ceads`: 对数碳排放强度
     - `emission_million_tons`: CEADs碳排放量（百万吨）
     - `real_gdp_100m_yuan`: 实际GDP（亿元）

2. **`CEADs_描述性统计表.xlsx`** (6.2 KB)
   - 详细的描述性统计表
   - 包含全样本、处理组、对照组的均值和标准差

## 中间文件（可删除）

- `CEADs_2007-2019_清洗后_修正版.xlsx`: 清洗后的CEADs数据
- `实际GDP_2007-2019_清洗后_修正版.xlsx`: 清洗后的GDP数据
- `合并后数据集_2007-2019_修正版.xlsx`: 合并后的原始数据（未计算碳排放强度）
- `step*.py`: 各步骤的处理脚本
- `debug_match_key.py`, `test_merge.py`: 调试脚本

## 与主数据集的对比

### 优势
1. **数据来源权威**：CEADs是国际认可的碳排放数据库
2. **时间跨度合理**：2007-2019年，覆盖政策实施前后
3. **单位标准化**：碳排放强度单位为"吨/万元"，符合经济学惯例

### 局限性
1. **时间截止于2019年**：无法评估近期政策效果（2020-2023）
2. **城市覆盖不全**：仅74.4%的城市有匹配数据
3. **观测数较少**：2,271个有效观测，远少于主数据集

## 使用建议

1. **主分析**：继续使用原有碳排放数据（时间跨度2007-2023，样本量大）
2. **稳健性检验**：使用CEADs数据作为替代数据源，验证结果稳健性
3. **子样本分析**：可对212个CEADs覆盖的城市进行深入分析

## 技术说明

### 匹配键构造
- CEADs数据：去除省份前缀（"四川成都" → "成都"）和后缀
- 主数据集/GDP数据：仅去除后缀（"成都市" → "成都"）

### 单位换算公式
```
碳排放强度(吨/万元) = (排放量(百万吨) / GDP(亿元)) × 100
```

推导过程：
- 1百万吨 = 100万吨
- 1亿元 = 10,000万元
- 吨/万元 = (百万吨 × 100) / (亿元 × 10,000) = (百万吨/亿元) × 0.01
- 为避免数值过小，乘以100：(百万吨/亿元) × 100

## 数据质量验证

✅ 均值在合理范围（0.5-5.0吨/万元）
✅ 与原有数据相关系数较高（0.7668）
✅ 处理组碳排放强度低于对照组（符合预期）
✅ 无极端异常值（已缩尾处理）

## 日期

创建日期：2025年1月17日
最后更新：2025年1月17日
