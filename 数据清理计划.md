# 数据清理计划

## 一、现有数据清单

### 1. 产业结构数据
**文件名：** `2000-2023地级市产业结构 - 面板.xls`
**大小：** 2.3 MB
**时间范围：** 2000-2023年
**样本数量：** 330个地级市
**数据指标：**
- 年度标识
- 城市名称
- 城市代码
- 城市类别
- 省份名称
- GDP（亿元人民币）
- 第一产业增加值（亿元人民币）
- 第二产业增加值（亿元人民币）
- 第三产业增加值（亿元人民币）
- 第一产业占GDP比重
- 第二产业占GDP比重
- 第三产业占GDP比重
- 产业结构（第三产业增加值/地区生产总值）
- 产业整体升级（加权指数）
- 产业结构高级化（第三产业增加值/第二产业增加值）

**数据来源：** 各省市统计年鉴、国民经济和社会发展统计公报

### 2. GDP相关数据
**文件名：** `296个地级市GDP相关数据（以2000年为基期）.xlsx`
**大小：** 395 KB
**样本数量：** 296个地级市
**说明：** 以2000年为基期的GDP平减数据

### 3. 人口密度数据
**文件名：** `298个地级市人口密度1998-2024年无缺失.xlsx`
**大小：** 512 KB
**时间范围：** 1998-2024年
**样本数量：** 298个地级市
**特点：** 无缺失值

### 4. 碳排放强度数据
**文件名：** `地级市碳排放强度.xlsx`
**大小：** 521 KB
**说明：** 地级市层面的碳排放强度指标

---

## 二、数据问题识别

### 1. 样本不一致问题
- **产业结构数据：** 330个地级市
- **GDP数据：** 296个地级市
- **人口密度数据：** 298个地级市
- **碳排放数据：** 待确认

**问题：** 不同数据源的样本数量不一致，需要进行样本匹配和筛选。

### 2. 时间跨度不一致
- **产业结构数据：** 2000-2023年（24年）
- **人口密度数据：** 1998-2024年（27年）
- **其他数据：** 待确认

**问题：** 研究需要统一的时间范围，建议取交集。

### 3. 城市代码标准化
不同数据源可能使用不同的城市代码系统，需要统一为标准的行政区划代码。

### 4. 缺失值处理
虽然人口密度数据声称"无缺失"，但其他数据集可能存在缺失值，需要：
- 检查缺失值的分布
- 决定删除还是插补
- 对于关键变量，考虑使用插值法填充

---

## 三、数据清理步骤

### 步骤1：数据导入与初步检查
1. 将所有Excel文件导入统计软件（Stata/R/Python）
2. 查看每个数据集的变量名、类型、样本量
3. 检查关键变量的描述性统计
4. 识别异常值和缺失值

### 步骤2：城市代码统一
1. 确定统一的城市代码标准（建议使用国家统计局6位行政区划代码）
2. 为每个数据集添加标准城市代码
3. 通过城市名称和省份进行匹配
4. 检查匹配精度，处理同名城市问题

### 步骤3：样本匹配
1. 以**产业结构数据（330个城市）**为基础
2. 筛选出其他数据集中存在的城市
3. 确定最终研究样本（预计290-300个城市）
4. 记录被排除的城市及原因

### 步骤4：时间范围统一
1. 确定研究时间范围（建议：2010-2023年）
   - 起始年份考虑：低碳城市试点从2010年开始
   - 截止年份考虑：最新可得数据年份
2. 删除时间范围外的观测
3. 检查时间连续性

### 步骤5：变量标准化
1. **GDP数据：** 确保所有GDP数据以2000年为基期
2. **人口密度：** 计算对数形式，减少异方差
3. **产业结构：** 确保计算公式一致
4. **碳排放强度：** 标准化单位（如吨CO2/万元GDP）

### 步骤6：生成核心变量
根据研究需要，生成以下核心变量：

#### 6.1 被解释变量
- **产业升级指标1：** 产业结构高级化 = 第三产业增加值/第二产业增加值
- **产业升级指标2：** 产业结构水平 = 第三产业增加值/GDP
- **产业升级指标3：** 产业整体升级指数

#### 6.2 核心解释变量
- **低碳试点城市：** 虚拟变量（1=试点城市，0=非试点城市）
- **政策实施时间：** 虚拟变量（政策实施后=1，实施前=0）
- **DID交互项：** 试点城市 × 政策实施时间

#### 6.3 控制变量
- **经济发展水平：** ln(人均GDP)
- **人口密度：** ln(人口密度)
- **政府干预程度：** 财政支出/GDP
- **对外开放程度：** FDI/GDP（如有数据）
- **城市化水平：** 城镇人口/总人口
- **基础设施水平：** 人均道路面积（如有数据）
- **人力资本：** 平均受教育年限（如有数据）

### 步骤7：异常值处理
1. 对连续变量进行 Winsorize 处理（1%和99%分位数）
2. 检查GDP增长率异常值（>100%或<0）
3. 检查人口密度极端值
4. 记录所有处理的异常值

### 步骤8：缺失值处理
1. 分析缺失值模式（MCAR, MAR, MNAR）
2. 对于随机缺失，使用插值法（如线性插值、均值插补）
3. 对于非随机缺失，考虑删除样本
4. 关键变量的缺失值不宜超过5%

### 步骤9：数据合并
1. 将所有清理后的数据按"城市代码-年份"合并
2. 检查合并后的数据完整性
3. 确保每个城市每年都有完整的观测

### 步骤10：最终数据集描述
1. 报告最终样本量（城市数×年数）
2. 制作变量的描述性统计表
3. 绘制关键变量的时间趋势图
4. 生成数据清理日志

---

## 四、数据质量检查清单

- [ ] 所有变量名称规范统一
- [ ] 城市代码匹配准确
- [ ] 时间范围一致
- [ ] 无重复观测
- [ ] 缺失值处理合理
- [ ] 异常值处理得当
- [ ] 变量单位统一
- [ ] 数据类型正确
- [ ] 样本量充分
- [ ] 符合研究设计要求

---

## 五、预期输出文件

### 文件1：清理后的面板数据
**文件名：** `cleaned_panel_data.dta`（Stata格式）
**内容：** 城市代码-年份维度的完整面板数据

### 文件2：变量说明文档
**文件名：** `variable_codebook.xlsx`
**内容：** 变量名、标签、单位、来源、计算公式

### 文件3：描述性统计表
**文件名：** `descriptive_stats.xlsx`
**内容：** 主要变量的均值、标准差、最小值、最大值

### 文件4：数据清理日志
**文件名：** `data_cleaning_log.txt`
**内容：** 清理步骤、决策理由、样本变化记录

---

## 六、注意事项

1. **备份原始数据**：所有清理操作前，备份原始数据文件
2. **可重复性**：记录所有清理步骤，确保可重复
3. **数据追溯**：保留中间版本，便于问题追溯
4. **样本代表性**：清理后检查样本是否仍具有代表性
5. **政策匹配**：确保试点城市名单与政策文件一致

---

## 七、下一步工作

1. **数据导入**：将Excel文件导入Stata/Python
2. **探索性分析**：查看数据分布、缺失情况
3. **样本匹配**：完成城市代码匹配和样本筛选
4. **变量生成**：生成核心研究变量
5. **描述性分析**：制作描述性统计表和图表
6. **实证分析**：构建DID模型进行政策评估

---

**文档创建时间：** 2025年1月2日
**最后更新：** 2025年1月2日
**负责人：** 王晓阳
